// Lake 20160507
// http://hellolake.duapp.com/
// https://github.com/hellolake/lake.js
!function(){var l,m;window.lake||(window.lake={}),lake.whats=function(a,b){return!0!==b&&a&&1==a.nodeType?"HTMLElement":Object.prototype.toString.call(a).replace(/[\[\]\s]|object/g,"")},lake.select=function(a){if(a===window||9==a.nodeType||1==a.nodeType)return a;if(/(window|document)/.test(a))return eval(a);var b;if("string"==typeof a)b=document.querySelectorAll(a);else{if("HTMLCollection"!=this.whats(a)&&"NodeList"!=this.whats(a))return console.error("Argument:"+a+" can not be selected."),null;b=a}return 1==b.length?b[0]:1<b.length?b:(console.error("No selectable element in: "+a+"."),null)},lake.each=function(a,b,c){if(a.length){var d;if(!0===c)for(c=a.length;c--;)b(a[c],c);else for(c=0,d=a.length;d>c;c++)b.call(a[c],a[c],c)}else if("Object"==this.whats(a))for(d in a)a.hasOwnProperty(d)&&b.call(a[d],a[d],d);else console.error("Arg[0]:"+a+" can not be traversed.")},lake.offset=function(a,b){var e,c=this.select(a),d=b?this.select(b):void 0;if(1==c.nodeType){if(e=c.getBoundingClientRect(),!d||9==d.nodeType)return c=c.ownerDocument.documentElement.getBoundingClientRect(),{top:e.top-c.top,left:e.left-c.left};if(d===window)return{top:e.top,left:e.left};if(1==d.nodeType)return c=d.getBoundingClientRect(),{top:e.top-c.top,left:e.left-c.left};console.error("Arg[1]:"+b+" is not an element.")}else console.error("Arg[0]:"+a+"is not an element.")},lake.css=function(a,b,c){!0!==c?(a=this.select(a),a.length?this.each(a,function(a){a.style.cssText+=";"+b}):a.style.cssText+=";"+b):"string"==typeof a?(this.style||(this.style=document.createElement("style"),document.head.appendChild(this.style)),this.style.innerHTML+=a+"{"+b+"}"):console.error("Arg[0]:obj must be a selector string when enable internal.")},lake.match=function(a,b,c,d){if("string"==typeof b){var e=function(a,b){return a.nodeType&&9==a.nodeType?!1:/^\.\w+$/.test(b)?a.classList.contains(b.replace(/\./,"")):/^#\w+$/.test(b)?a.id==b.replace(/#/,""):/^\w+$/.test(b)?a.tagName==b.toUpperCase():/:first-child$/.test(b)?e(a,b.replace(/:first-child$/,""))&&a.parentNode.firstElementChild===a:/:last-child$/.test(b)?e(a,b.replace(/:last-child$/,""))&&a.parentNode.lastElementChild===a:void 0},f=d?d:document,g={};return c&&c.nodeType&&(f=c),this.each(b.split(","),function(b){var d,h,i,j,k,l,m,n,o,p;for(d=!0,h=b.replace(/\s*([>\+~])\s*/g,"$1").match(/\S+/g),i=h.length,j=i;j--;){for(k=a,l=h[j].match(/[>\+~]|[#.]?\w+(?::\S+|\[\S+])?/g),m=l.length;m--;)if(n=l[m],/^[\.#]?\w+(?::\S+|\[\S+])?$/.test(n)){if(k.nodeType){if(!e(k,n)){if(!(i-1>j&&k!==f)){d=!1;break}k=k.parentNode,m++}}else if(k.length)for(d=!1,o=0,p=k.length;p>o;o++)if(e(k[o],n)){k=k[o],d=!0;break}}else if(/^>$/.test(n))k=k.parentNode;else if(/^\+$/.test(n))k=k.previousElementSibling;else if(/^~$/.test(n)){for(n=[],k=k.previousElementSibling;!k;)n.push(k),k=k.previousElementSibling;k=n}if(!d||k===f)break}g[b]=d,c&&"function"==typeof c&&c.call(a,d,b)}),g}console.error("Arg[1]:selector must be a selector string.")},lake.listen=function(a,b,c,d){a=this.select(a),a.length?this.each(a,function(a){a.addEventListener(b,c,!0===d)}):a.addEventListener(b,c,!0===d)},lake.deaf=function(a,b,c,d){a=this.select(a),a.length?this.each(a,function(a){a.removeEventListener(b,c,!0===d)}):a.removeEventListener(b,c,!0===d)},lake.ajax=function(a,b,c){var e,f,g,d={type:"",data:null,onloadstart:null,onload:null,onloadend:null,onprogress:null,onabort:null,onerror:null,timeout:5e3,ontimeout:null,asyn:!0,credentials:!1,name:"",password:"",header:null,mime:null};if(c)for(e in c)d[e]=c[e];if(f=new XMLHttpRequest,a=a.toUpperCase(),c=d.data?f.upload:f,d.onloadstart&&c.addEventListener("loadstart",function(a){d.onloadstart(f,a)},!1),d.onload&&c.addEventListener("load",function(a){d.onload(f,a)},!1),d.onloadend&&c.addEventListener("loadend",function(a){d.onloadend(f,a)},!1),d.onprogress&&c.addEventListener("progress",function(a){d.onprogress(f,a)},!1),d.onabort&&c.addEventListener("abort",function(a){d.onabort(f,a)},!1),d.onerror&&c.addEventListener("error",function(a){d.onabort(f,a)},!1),d.ontimeout&&c.addEventListener("timeout",function(a){d.ontimeout(f,a)},!1),f.responseType=d.type,f.withCredentials=d.credentials,f.open(a,b,d.asyn,d.name,d.password),f.timeout=d.timeout,d.header)for(g in d.header)f.setRequestHeader(g,d.header[g]);return d.mime&&f.overrideMimeType(d.mime),f.send(d.data),f},l=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,l.prototype.add=function(a,b){function c(a){f?(d.observe(a,f),a._mo_cfg=f):a._mo_cfg?d.observe(a,a._mo_cfg):(d.observe(a,g),a._mo_cfg=g),0>d.objs.indexOf(a)&&d.objs.push(a)}var f,d=this,e=lake.select(a),g={attributes:!1,childList:!0,characterData:!1,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1};"Object"==lake.whats(b)&&(f=b),this.objs||(this.objs=[]),e.length?lake.each(e,function(a){c(a)}):c(e)},l.prototype.del=function(a){var b,c;this.disconnect(),a&&this.objs&&(b=function(a){a._mo_cfg&&delete a._mo_cfg,c.objs=c.objs.filter(function(b){return b!==a})},a=lake.select(a),c=this,a.length?lake.each(a,function(a){b(a)}):b(a),0<c.objs.length&&c.add(c.objs))},lake.mutation=function(a){return new l(a)},m=function(a,b){var c=this;this.listener="string"==typeof a?a.trim().replace(/\s+/g," ").replace(/\s*([>\+~])\s*/g,"$1"):a,this.basement=b,this.event={},this.target={},this.main=function(a){c.processor.call(this,a,c)}},m.prototype={processor:function(a,b){var c=!0===b.basement?this:b.basement.nodeType?b.basement:void 0;"{}"!=JSON.stringify(b.event)&&0<b.event[a.type].length&&lake.each(b.event[a.type],function(b){b.call(a.target,a)}),"{}"!=JSON.stringify(b.target)&&b.target[a.type]&&lake.each(b.target[a.type],function(b,d){0<b.length&&lake.match(a.target,d,function(c){c&&lake.each(b,function(b){b.call(a.target,a)})},c)})},add:function(a,b,c,d){if("boolean"==typeof c&&(d=c,c=void 0),"string"==typeof a&&"function"==typeof b&&(c=b,b=a,a=void 0),"string"==typeof a&&"string"==typeof b){if(!document.querySelector(a))return console.error("Arg[0]:target must be an available selector string."),void 0;a=a.trim().replace(/\s+/g," ").replace(/\s*([>+~])\s*/g,"$1")}this.event[b]||(this.event[b]=[],lake.listen(this.listener,b,this.main,d)),a&&a!==this.listener?this.target[b]?this.target[b][a]?0>this.target[b][a].indexOf(c)&&this.target[b][a].push(c):this.target[b][a]=[c]:(this.target[b]={},this.target[b][a]=[c]):a&&a!==this.listener||0>this.event[b].indexOf(c)&&this.event[b].push(c)},del:function(a,b,c,d){var f,e=this;a?"string"==typeof a&&document.querySelector(a)?"string"==typeof b&&"function"==typeof c?(f=e.target[b][a],b=f.indexOf(c),b>-1&&f.splice(b,1)):"string"!=typeof b||c?b||lake.each(e.target,function(b){b[a]&&delete b[a]}):delete e.target[b][a]:"string"==typeof a?"function"==typeof b?(f=e.event[a],b=f.indexOf(b),b>-1&&f.splice(b,1)):b||e.event[a].splice(0):console.error("Arguments must be like: (target,event,fn) or (target,event) or (target) to delete child event. (event,fn) or (event) to delete self event."):lake.each(e.event,function(a,b){lake.deaf(e.listener,b,e.main,d),delete e.event[b],delete e.target[b]})}},lake.listener=function(a,b){return new m(a,b)}}();